<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Interview System Debug</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    .debug-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
    .output { background: #f5f5f5; padding: 15px; border-radius: 4px; white-space: pre-wrap; max-height: 300px; overflow-y: auto; }
    button { padding: 10px 20px; margin: 5px; }
  </style>
</head>
<body>
  <h1>üîß n8n Webhook Debug Tool</h1>
  
  <div class="debug-section">
    <h3>Test Interview Verification Webhook</h3>
    <button onclick="testWebhook()">Test Current Webhook</button>
    <button onclick="testWithDifferentPayloads()">Test Multiple Payloads</button>
    <div id="output" class="output">Click a button to start testing...</div>
  </div>

  <script>
    async function testWebhook() {
      const output = document.getElementById('output');
      output.textContent = 'Testing webhook...\n';
      
      try {
        const response = await fetch('https://kraig-unjustified-collinearly.ngrok-free.dev/webhook/interview-verify', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          },
          mode: 'cors',
          body: JSON.stringify({ token: 'test-token' })
        });
        
        output.textContent += `Status: ${response.status} ${response.statusText}\n`;
        output.textContent += `Headers: ${JSON.stringify(Object.fromEntries(response.headers), null, 2)}\n`;
        
        if (response.ok) {
          const data = await response.json();
          output.textContent += `‚úÖ Success!\nResponse: ${JSON.stringify(data, null, 2)}\n`;
        } else {
          const errorText = await response.text();
          output.textContent += `‚ùå Error Response: ${errorText}\n`;
        }
        
      } catch (error) {
        output.textContent += `‚ùå Network Error: ${error.message}\n`;
      }
    }

    async function testWithDifferentPayloads() {
      const output = document.getElementById('output');
      output.textContent = 'Testing multiple payload formats...\n';
      
      const payloads = [
        { token: 'test-token' },
        { sessionToken: 'test-session' },
        { id: 'test-id' },
        { candidateName: 'Test User', sessionId: 'test-123' },
        {}
      ];
      
      for (let i = 0; i < payloads.length; i++) {
        const payload = payloads[i];
        output.textContent += `\nTesting payload ${i + 1}: ${JSON.stringify(payload)}\n`;
        
        try {
          const response = await fetch('https://kraig-unjustified-collinearly.ngrok-free.dev/webhook/interview-verify', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Accept': 'application/json'
            },
            mode: 'cors',
            body: JSON.stringify(payload)
          });
          
          output.textContent += `  Status: ${response.status}\n`;
          
          if (response.ok) {
            const data = await response.json();
            output.textContent += `  ‚úÖ Success: ${JSON.stringify(data)}\n`;
          } else {
            const errorText = await response.text();
            output.textContent += `  ‚ùå Error: ${errorText.substring(0, 100)}...\n`;
          }
          
        } catch (error) {
          output.textContent += `  ‚ùå Failed: ${error.message}\n`;
        }
      }
    }
  </script>
</body>
</html>