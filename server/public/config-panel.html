<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuration Panel - Interview System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8fafc;
            color: #1f2937;
        }

        .navbar {
            background: linear-gradient(135deg, #5dc399, #7be1b6);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-brand {
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-actions a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: background 0.3s;
        }

        .nav-actions a:hover {
            background: rgba(255,255,255,0.2);
        }

        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .tab {
            padding: 1rem 1.5rem;
            background: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: #6b7280;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tab.active {
            background: linear-gradient(135deg, #5dc399, #7be1b6);
            color: white;
        }

        .tab:hover:not(.active) {
            background: #f3f4f6;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .config-section {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .config-section h2 {
            color: #065f46;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
        }

        .form-group textarea {
            min-height: 150px;
            font-family: 'Courier New', monospace;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #5dc399;
        }

        .help-text {
            font-size: 0.9rem;
            color: #6b7280;
            margin-top: 0.5rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #5dc399, #7be1b6);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(93, 195, 153, 0.4);
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .preview-box {
            background: #f9fafb;
            border: 2px dashed #e5e7eb;
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .preview-box h3 {
            color: #065f46;
            margin-bottom: 1rem;
        }

        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .alert-info {
            background: #dbeafe;
            color: #1e40af;
            border-left: 4px solid #3b82f6;
        }

        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border-left: 4px solid #10b981;
        }

        .alert-warning {
            background: #fef3c7;
            color: #92400e;
            border-left: 4px solid #f59e0b;
        }

        .code-block {
            background: #1f2937;
            color: #f3f4f6;
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .variable-tag {
            display: inline-block;
            background: #5dc399;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.85rem;
            font-family: monospace;
            margin: 0.25rem;
        }

        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }

            .tab {
                width: 100%;
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-cog"></i>
                Configuration Panel
            </div>
            <div class="nav-actions">
                <a href="/demo-portal.html"><i class="fas fa-home"></i> Back to Portal</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('email')">
                <i class="fas fa-envelope"></i> Email Settings
            </button>
            <button class="tab" onclick="showTab('vapi')">
                <i class="fas fa-microphone"></i> VAPI Configuration
            </button>
            <button class="tab" onclick="showTab('timing')">
                <i class="fas fa-clock"></i> Time Windows
            </button>
            <button class="tab" onclick="showTab('branding')">
                <i class="fas fa-palette"></i> Branding
            </button>
            <button class="tab" onclick="showTab('advanced')">
                <i class="fas fa-tools"></i> Advanced
            </button>
        </div>

        <!-- Email Settings Tab -->
        <div id="email-tab" class="tab-content active">
            <div class="config-section">
                <h2><i class="fas fa-envelope"></i> Email Configuration</h2>
                
                <div class="alert alert-info">
                    <strong>Available Variables:</strong>
                    <div style="margin-top: 0.5rem;">
                        <span class="variable-tag">{name}</span>
                        <span class="variable-tag">{email}</span>
                        <span class="variable-tag">{date}</span>
                        <span class="variable-tag">{time}</span>
                        <span class="variable-tag">{interviewLink}</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>Interview Link Base URL</label>
                    <input type="url" id="baseUrl" value="http://localhost:3000" placeholder="https://your-domain.com">
                    <div class="help-text">This URL will be used in confirmation emails. Update for production deployment.</div>
                </div>

                <div class="form-group">
                    <label>Email Subject</label>
                    <input type="text" id="emailSubject" value="Your Interview with Bloom Buddies üå±">
                </div>

                <div class="form-group">
                    <label>Email Template</label>
                    <textarea id="emailTemplate">Hi {name},

Thank you for scheduling your interview with Bloom Buddies!

Interview Details:
üìÖ Date: {date}
‚è∞ Time: {time} CET
üéôÔ∏è Duration: Approximately 10-15 minutes

When you're ready to start your interview, click the link below:
{interviewLink}

Important Notes:
‚Ä¢ The interview window opens 5 minutes before your scheduled time
‚Ä¢ You'll have up to 30 minutes after your scheduled time to complete it
‚Ä¢ The interview is conducted via voice AI - just speak naturally
‚Ä¢ If you experience connection issues, you can retry within the first 30 seconds

Best regards,
The Bloom Buddies Team</textarea>
                    <div class="help-text">Use the variables above to personalize the email.</div>
                </div>

                <div class="preview-box">
                    <h3>Preview</h3>
                    <div id="emailPreview" style="white-space: pre-wrap; font-family: inherit; color: #374151;">
                        <!-- Preview will be generated here -->
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="saveEmailConfig()">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                    <button class="btn btn-secondary" onclick="testEmail()">
                        <i class="fas fa-paper-plane"></i> Send Test Email
                    </button>
                    <button class="btn btn-secondary" onclick="resetEmailDefaults()">
                        <i class="fas fa-undo"></i> Reset to Defaults
                    </button>
                </div>
            </div>
        </div>

        <!-- VAPI Configuration Tab -->
        <div id="vapi-tab" class="tab-content">
            <div class="config-section">
                <h2><i class="fas fa-microphone"></i> VAPI Interview Configuration</h2>

                <div class="alert alert-warning">
                    <strong>Note:</strong> Changes to VAPI settings require updating your VAPI assistant configuration separately.
                </div>

                <div class="form-group">
                    <label>Assistant ID</label>
                    <input type="text" id="vapiAssistantId" placeholder="Your VAPI Assistant ID">
                    <div class="help-text">Found in your VAPI dashboard under Assistants.</div>
                </div>

                <div class="form-group">
                    <label>Interview Questions / Prompts</label>
                    <textarea id="vapiPrompts" style="min-height: 300px;">Example interview flow:

1. Introduction
"Hello! Thank you for interviewing with Bloom Buddies. I'm going to ask you a few questions about your experience and skills. Let's begin!"

2. Background Questions
- Tell me about your previous work experience
- What interests you about this position?
- What are your key strengths?

3. Behavioral Questions
- Describe a challenging situation you've faced and how you handled it
- How do you work in a team environment?
- Where do you see yourself in 5 years?

4. Closing
"Thank you for your time today. We'll review your responses and get back to you soon. Have a great day!"</textarea>
                    <div class="help-text">Define the questions and conversation flow for your AI interviewer.</div>
                </div>

                <div class="form-group">
                    <label>Expected Interview Duration (minutes)</label>
                    <input type="number" id="interviewDuration" value="15" min="5" max="60">
                </div>

                <div class="form-group">
                    <label>Minimum Call Duration (seconds)</label>
                    <input type="number" id="minCallDuration" value="30" min="10" max="300">
                    <div class="help-text">Minimum duration before marking interview as complete (prevents accidental disconnects).</div>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="saveVapiConfig()">
                        <i class="fas fa-save"></i> Save Configuration
                    </button>
                    <button class="btn btn-secondary" onclick="openVapiDashboard()">
                        <i class="fas fa-external-link-alt"></i> Open VAPI Dashboard
                    </button>
                </div>
            </div>
        </div>

        <!-- Time Windows Tab -->
        <div id="timing-tab" class="tab-content">
            <div class="config-section">
                <h2><i class="fas fa-clock"></i> Interview Time Windows</h2>

                <div class="form-group">
                    <label>Window Opens (minutes before scheduled time)</label>
                    <input type="number" id="windowBefore" value="5" min="0" max="60">
                    <div class="help-text">Candidates can start their interview this many minutes early.</div>
                </div>

                <div class="form-group">
                    <label>Window Closes (minutes after scheduled time)</label>
                    <input type="number" id="windowAfter" value="30" min="5" max="120">
                    <div class="help-text">Candidates have this long after their scheduled time to complete the interview.</div>
                </div>

                <div class="form-group">
                    <label>Default Timezone</label>
                    <select id="timezone">
                        <option value="CET">Central European Time (CET)</option>
                        <option value="EST">Eastern Standard Time (EST)</option>
                        <option value="PST">Pacific Standard Time (PST)</option>
                        <option value="GMT">Greenwich Mean Time (GMT)</option>
                        <option value="UTC">Coordinated Universal Time (UTC)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Available Hours</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div>
                            <label>Start Time</label>
                            <select id="startHour">
                                <option value="6">6:00 AM</option>
                                <option value="7" selected>7:00 AM</option>
                                <option value="8">8:00 AM</option>
                                <option value="9">9:00 AM</option>
                            </select>
                        </div>
                        <div>
                            <label>End Time</label>
                            <select id="endHour">
                                <option value="17">5:00 PM</option>
                                <option value="18">6:00 PM</option>
                                <option value="19" selected>7:00 PM</option>
                                <option value="20">8:00 PM</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="saveTimingConfig()">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                </div>
            </div>
        </div>

        <!-- Branding Tab -->
        <div id="branding-tab" class="tab-content">
            <div class="config-section">
                <h2><i class="fas fa-palette"></i> Branding & Appearance</h2>

                <div class="form-group">
                    <label>Company Name</label>
                    <input type="text" id="companyName" value="Bloom Buddies">
                </div>

                <div class="form-group">
                    <label>Primary Color</label>
                    <input type="color" id="primaryColor" value="#5dc399">
                    <div class="help-text">Main brand color used throughout the application.</div>
                </div>

                <div class="form-group">
                    <label>Secondary Color</label>
                    <input type="color" id="secondaryColor" value="#7be1b6">
                    <div class="help-text">Accent color for gradients and highlights.</div>
                </div>

                <div class="form-group">
                    <label>Logo URL (optional)</label>
                    <input type="url" id="logoUrl" placeholder="https://example.com/logo.png">
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="saveBrandingConfig()">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                    <button class="btn btn-secondary" onclick="previewBranding()">
                        <i class="fas fa-eye"></i> Preview Changes
                    </button>
                </div>
            </div>
        </div>

        <!-- Advanced Tab -->
        <div id="advanced-tab" class="tab-content">
            <div class="config-section">
                <h2><i class="fas fa-tools"></i> Advanced Settings</h2>

                <div class="alert alert-warning">
                    <strong>Warning:</strong> These settings require environment variable changes and server restart.
                </div>

                <div class="form-group">
                    <label>Airtable Base ID</label>
                    <input type="text" id="airtableBaseId" placeholder="appXXXXXXXXXXXXXX">
                    <div class="help-text">Your Airtable base identifier.</div>
                </div>

                <div class="form-group">
                    <label>Airtable Table Name</label>
                    <input type="text" id="airtableTableName" value="Candidates">
                </div>

                <div class="form-group">
                    <label>SMTP Email From Address</label>
                    <input type="email" id="emailFrom" value="info@xenergies.com">
                </div>

                <div class="code-block">
                    <div><strong>Environment Variables (.env file)</strong></div>
                    <pre style="margin-top: 1rem;">AIRTABLE_API_KEY=your_api_key_here
AIRTABLE_BASE_ID=your_base_id
AIRTABLE_TABLE_NAME=Candidates
VAPI_API_KEY=your_vapi_key
VAPI_ASSISTANT_ID=your_assistant_id
GMAIL_EMAIL=your_email@gmail.com
GMAIL_APP_PASSWORD=your_app_password
FRONTEND_URL=http://localhost:3000</pre>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="downloadEnvTemplate()">
                        <i class="fas fa-download"></i> Download .env Template
                    </button>
                    <button class="btn btn-secondary" onclick="window.open('/dashboard/AIRTABLE_PAT_GUIDE.md')">
                        <i class="fas fa-book"></i> View Setup Guide
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.closest('.tab').classList.add('active');
        }

        // Email preview
        function updateEmailPreview() {
            const template = document.getElementById('emailTemplate').value;
            const preview = template
                .replace(/{name}/g, 'John Doe')
                .replace(/{email}/g, 'john.doe@example.com')
                .replace(/{date}/g, 'Monday, December 9, 2025')
                .replace(/{time}/g, '2:00 PM')
                .replace(/{interviewLink}/g, '[Interview Link Button]');
            
            document.getElementById('emailPreview').textContent = preview;
        }

        // Initialize email preview
        document.getElementById('emailTemplate').addEventListener('input', updateEmailPreview);
        updateEmailPreview();

        // Save functions
        function saveEmailConfig() {
            alert('Email configuration saved!\n\nNote: This is a demo. In production, these settings would be saved to your backend configuration.');
        }

        function saveVapiConfig() {
            alert('VAPI configuration saved!\n\nRemember to also update your VAPI assistant settings in the VAPI dashboard.');
        }

        function saveTimingConfig() {
            alert('Timing configuration saved!\n\nChanges will take effect immediately for new interview scheduling.');
        }

        function saveBrandingConfig() {
            alert('Branding configuration saved!\n\nRefresh your pages to see the changes.');
        }

        function testEmail() {
            const email = prompt('Enter email address to send test email:');
            if (email) {
                alert('Test email sent to: ' + email + '\n\nCheck your inbox!');
            }
        }

        function resetEmailDefaults() {
            if (confirm('Reset email template to defaults?')) {
                location.reload();
            }
        }

        function openVapiDashboard() {
            window.open('https://dashboard.vapi.ai', '_blank');
        }

        function previewBranding() {
            alert('Branding preview would show here.\n\nIn production, this would open a live preview of your changes.');
        }

        function downloadEnvTemplate() {
            const template = `# Airtable Configuration
AIRTABLE_API_KEY=your_api_key_here
AIRTABLE_BASE_ID=your_base_id
AIRTABLE_TABLE_NAME=Candidates

# VAPI Configuration
VAPI_API_KEY=your_vapi_key
VAPI_ASSISTANT_ID=your_assistant_id

# Email Configuration
GMAIL_EMAIL=your_email@gmail.com
GMAIL_APP_PASSWORD=your_app_password

# Server Configuration
PORT=3000
FRONTEND_URL=http://localhost:3000
`;
            
            const blob = new Blob([template], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = '.env.template';
            a.click();
        }
    </script>
</body>
</html>
